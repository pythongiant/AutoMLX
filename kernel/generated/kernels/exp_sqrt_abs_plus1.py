# kernel/generated/kernels/exp_sqrt_abs_plus1.py
"""
Hand-written generated kernel.

This kernel is assumed to be generated by an LLM,
but written here manually as a gold-standard example.

Contract:
- PURE MLX
- NO side effects
- NO global mutation
- Deterministic
- ABI-compatible with KernelIR
"""

import mlx.core as mx


def kernel(t0):
    """
    Args:
        t0: mx.array, arbitrary shape, float32

    Returns:
        mx.array with same shape/dtype
    """

    # IMPORTANT:
    # Every intermediate must be an MLX array
    # No Python scalars except literals

    t1 = mx.abs(t0)
    t2 = t1 + 1
    t3 = mx.sqrt(t2)
    t4 = mx.exp(t3)

    return t4
